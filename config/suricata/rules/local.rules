# Règles locales pour Suricata
# Ces règles seront chargées en plus des règles principales

# Règle de détection des tentatives d'accès aux services internes
alert tcp any any -> $HOME_NET 3000 (msg:"POLICY ntopng access attempt"; flow:to_server; threshold:type threshold, track by_src, count 5, seconds 60; classtype:policy-violation; sid:2000001; rev:1;)
alert tcp any any -> $HOME_NET 19999 (msg:"POLICY netdata access attempt"; flow:to_server; threshold:type threshold, track by_src, count 5, seconds 60; classtype:policy-violation; sid:2000002; rev:1;)
alert tcp any any -> $HOME_NET 9090 (msg:"POLICY prometheus access attempt"; flow:to_server; threshold:type threshold, track by_src, count 5, seconds 60; classtype:policy-violation; sid:2000003; rev:1;)
alert tcp any any -> $HOME_NET 5601 (msg:"POLICY kibana access attempt"; flow:to_server; threshold:type threshold, track by_src, count 5, seconds 60; classtype:policy-violation; sid:2000004; rev:1;)

# Règle de détection des communications anormales entre conteneurs
alert ip $HOME_NET any -> $HOME_NET any (msg:"POLICY anomalous container communication"; flow:established; threshold:type threshold, track by_both, count 100, seconds 10; classtype:policy-violation; sid:2000005; rev:1;)
